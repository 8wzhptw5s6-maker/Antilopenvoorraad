<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Voorraadbeheer</title>
<style>
body { font-family: Arial; padding: 20px; }
input, button, select { padding: 6px; margin: 4px; }
table { border-collapse: collapse; margin-top: 20px; width: 100%; }
th, td { border: 1px solid #ccc; padding: 6px; text-align: center; }
th { background: #f0f0f0; }
</style>
</head>
<body>

<h2>ðŸ“¦ Voorraadbeheer</h2>

<h3>âž• Levering invoeren</h3>
<input id="l_artikel" placeholder="Artikel">
<input id="l_aantal" type="number" placeholder="Aantal">
<button onclick="levering()">Toevoegen</button>

<h3>âž– Verkoop invoeren</h3>
<input id="v_artikel" placeholder="Artikel">
<input id="v_aantal" type="number" placeholder="Aantal">
<button onclick="verkoop()">Toevoegen</button>

<h3>ðŸ“‹ Voorraad tellen</h3>
<input id="t_artikel" placeholder="Artikel">
<input id="t_aantal" type="number" placeholder="Geteld aantal">
<button onclick="telling()">Opslaan</button>

<button onclick="exporteer()">ðŸ“¤ Export Excel</button>

<table>
<thead>
<tr>
<th>Artikel</th>
<th>Leveringen</th>
<th>Verkopen</th>
<th>Verwacht</th>
<th>Geteld</th>
<th>Verschil</th>
</tr>
</thead>
<tbody id="tabel"></tbody>
</table>

<script>
let data = JSON.parse(localStorage.getItem("voorraad")) || {};

function getArtikel(naam) {
  if (!data[naam]) {
    data[naam] = { levering: 0, verkoop: 0, telling: null };
  }
  return data[naam];
}

function levering() {
  let a = l_artikel.value;
  let n = Number(l_aantal.value);
  if (!a || !n) return;
  getArtikel(a).levering += n;
  opslaan();
}

function verkoop() {
  let a = v_artikel.value;
  let n = Number(v_aantal.value);
  if (!a || !n) return;
  getArtikel(a).verkoop += n;
  opslaan();
}

function telling() {
  let a = t_artikel.value;
  let n = Number(t_aantal.value);
  if (!a && n !== 0) return;
  getArtikel(a).telling = n;
  opslaan();
}

function opslaan() {
  localStorage.setItem("voorraad", JSON.stringify(data));
  render();
}

function render() {
  const tbody = document.getElementById("tabel");
  tbody.innerHTML = "";
  for (let a in data) {
    let d = data[a];
    let verwacht = d.levering - d.verkoop;
    let verschil = d.telling !== null ? d.telling - verwacht : "";
    tbody.innerHTML += `
      <tr>
        <td>${a}</td>
        <td>${d.levering}</td>
        <td>${d.verkoop}</td>
        <td>${verwacht}</td>
        <td>${d.telling ?? ""}</td>
        <td>${verschil}</td>
      </tr>`;
  }
}

function exporteer() {
  let csv = "Artikel,Leveringen,Verkopen,Verwacht,Geteld,Verschil\n";
  for (let a in data) {
    let d = data[a];
    let verwacht = d.levering - d.verkoop;
    let verschil = d.telling !== null ? d.telling - verwacht : "";
    csv += `${a},${d.levering},${d.verkoop},${verwacht},${d.telling ?? ""},${verschil}\n`;
  }
  let blob = new Blob([csv], { type: "text/csv" });
  let link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "voorraad.csv";
  link.click();
}

render();
</script>

</body>
</html>
